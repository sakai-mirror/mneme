<?xml version="1.0" encoding="UTF-8"?>

<!--
/**********************************************************************************
 * $URL$
 * $Id$
 ***********************************************************************************
 *
 * Copyright (c) 2007 The Regents of the University of Michigan & Foothill College, ETUDES Project
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *      http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 **********************************************************************************/
-->

<interface title="list-title" header="list-header">
	<container>
		<entityList style="FLAT">
			<iterator name="submission" model="submissions">
				<model ref="submissions" />
			</iterator>
			<emptyTitle>
				<message selector="list-empty" />
			</emptyTitle>
			<columns>
				<modelColumn>
					<title>
						<message selector="list-header-title" />
					</title>
					<model ref="submission.assessment.title" />
					<sort>
						<active>
							<compareDecision>
								<model ref="sort_column" />
								<comparison>
									<constant value="0" />
								</comparison>
							</compareDecision>
						</active>
						<direction>
							<compareDecision model="sort_direction" constant="A" />
						</direction>
						<asc icon="/icons/sortascending.gif">
							<message selector="asc" />
							<destination template="/list/0A" />
						</asc>
						<desc icon="/icons/sortdescending.gif">
							<message selector="desc" />
							<destination template="/list/0D" />
						</desc>
					</sort>
					<navigations>
						<navigation style="LINK" title="list-nav-begin">
							<destination template="/enter/{0}" ref="submission.assessment.id" />
							<included>
								<decision model="submission.mayBegin" />
							</included>
						</navigation>
						<navigation style="LINK" title="list-nav-continue">
							<destination template="/question/{0}/z" ref="submission.id" />
							<included>
								<decision model="submission.mayContinue" />
							</included>
						</navigation>
						<navigation style="LINK" title="list-nav-begin-again">
							<destination template="/enter/{0}" ref="submission.assessment.id" />
							<included>
								<decision model="submission.mayBeginAgain" />
							</included>
						</navigation>
					</navigations>
				</modelColumn>
				<modelColumn em="10" wrap="FALSE" >
					<title>
						<message selector="list-status-title" />
					</title>
					<model type="html" delegate="FormatListDecoration" tool="sakai.mneme" />
					<sort>
						<active>
							<compareDecision>
								<model ref="sort_column" />
								<comparison>
									<constant value="1" />
								</comparison>
							</compareDecision>
						</active>
						<direction>
							<compareDecision model="sort_direction" constant="A" />
						</direction>
						<asc icon="/icons/sortascending.gif">
							<message selector="asc" />
							<destination template="/list/1A" />
						</asc>
						<desc icon="/icons/sortdescending.gif">
							<message selector="desc" />
							<destination template="/list/1D" />
						</desc>
					</sort>
					<entityNavigations>
						<navigation>
							<destination template="/enter/{0}" ref="submission.assessment.id" />
							<included>
								<decision model="submission.mayBegin" />
							</included>
						</navigation>
						<navigation>
							<destination template="/question/{0}/z" ref="submission.id" />
							<included>
								<decision model="submission.mayContinue" />
							</included>
						</navigation>
						<navigation>
							<destination template="/enter/{0}" ref="submission.assessment.id" />
							<included>
								<decision model="submission.mayBeginAgain" />
							</included>
						</navigation>
					</entityNavigations>
				</modelColumn>
				<modelColumn>
					<title>
						<message selector="list-header-open" />
					</title>
					<model type="date" twoLine="TRUE" missing="dash" ref="submission.assessment.releaseDate" />
				</modelColumn>
				<column>
					<title>
						<message selector="list-header-due" />
					</title>
					<sort>
						<active>
							<compareDecision>
								<model ref="sort_column" />
								<comparison>
									<constant value="2" />
								</comparison>
							</compareDecision>
						</active>
						<direction>
							<compareDecision model="sort_direction" constant="A" />
						</direction>
						<asc icon="/icons/sortascending.gif">
							<message selector="asc" />
							<destination template="/list/2A" />
						</asc>
						<desc icon="/icons/sortdescending.gif">
							<message selector="desc" />
							<destination template="/list/2D" />
						</desc>
					</sort>
					<container>
						<text>
							<message>
								<model type="date" twoLine="TRUE" missing="dash" ref="submission.assessment.dueDate" />
							</message>
							<included>
								<andDecision reversed="TRUE">
									<andDecision>
										<hasValueDecision model="submission.assessment.expiration" />
										<orDecision>
											<compareDecision model="submission.assessmentSubmissionStatus" constant="ready" />
											<andDecision>
												<compareDecision model="submission.assessmentSubmissionStatus">
													<comparison>
														<constant value="inProgress" />
														<constant value="inProgressAlert" />
													</comparison>
												</compareDecision>
												<hasValueDecision reversed="TRUE" model="submission.assessment.timeLimit" />
											</andDecision>
										</orDecision>
									</andDecision>
								</andDecision>
							</included>
						</text>
						<countdownTimer tight="TRUE" pixels="100">
							<duration>
								<message selector="timer-due">
									<model type="date" ref="submission.assessment.expiration.time" />
								</message>
								<model ref="submission.assessment.expiration.limit" />
							</duration>
							<remaining>
								<message selector="timer-remaining" />
							</remaining>
							<timeTillExpire>
								<model ref="submission.assessment.expiration.duration" />
							</timeTillExpire>
							<destination template="/list" />
							<included>
								<andDecision>
									<hasValueDecision model="submission.assessment.expiration" />
									<orDecision>
										<compareDecision model="submission.assessmentSubmissionStatus" constant="ready" />
										<andDecision>
											<compareDecision model="submission.assessmentSubmissionStatus">
												<comparison>
													<constant value="inProgress" />
													<constant value="inProgressAlert" />
												</comparison>
											</compareDecision>
											<hasValueDecision reversed="TRUE" model="submission.assessment.timeLimit" />
										</andDecision>
									</orDecision>
								</andDecision>
							</included>
						</countdownTimer>
					</container>
				</column>
				<column>
					<title>
						<message selector="list-header-limit" />
					</title>
					<container>
						<text>
							<message>
								<model type="duration" concise="TRUE" missing="dash" ref="submission.assessment.timeLimit" />
							</message>
							<included>
								<decision reversed="TRUE" model="submission.mayContinue" />
							</included>
						</text>
						<countdownTimer tight="TRUE" pixels="100">
							<duration>
								<message selector="timer-duration">
									<model type="duration" concise="TRUE" ref="submission.expiration.limit" />
								</message>
								<model ref="submission.expiration.limit" />
							</duration>
							<timeTillExpire>
								<model ref="submission.expiration.duration" />
							</timeTillExpire>
							<destination template="/list" />
							<included>
								<decision model="submission.mayContinue" />
								<hasValueDecision model="submission.assessment.timeLimit" />
							</included>
						</countdownTimer>
					</container>
				</column>
				<column wrap="FALSE">
					<title>
						<message selector="list-header-tries" />
					</title>
					<container>
						<text>
							<message selector="list-format-tries">
								<model ref="submission.siblingCount"/>
								<model ref="submission.assessment.numSubmissionsAllowed" missing="infinite" />
							</message>
						</text>
					</container>
				</column>
				<modelColumn>
					<title>
						<message selector="list-header-finished" />
					</title>
					<model type="date" twoLine="TRUE" missing="dash" ref="submission.best.submittedDate" />
					<entityIncluded selector="dash">
						<decision model="submission.best.isComplete" />
					</entityIncluded>
				</modelColumn>
				<column wrap="FALSE">
					<title>
						<message selector="list-header-grade" />
					</title>
					<container>
						<text>
							<message selector="list-format-grade">
								<model ref="submission.best" delegate="FormatListGrade" tool="sakai.mneme" />
							</message>
						</text>
					</container>
					<navigations>
						<navigation style="LINK" title="list-nav-review">
							<destination template="/review/{0}" ref="submission.best.id" />
							<included>
								<decision model="submission.best.mayReview" />
							</included>
						</navigation>
						<navigation style="LINK" disabled="TRUE">
							<title>
								<message selector="list-nav-review-later">
									<model type="date" ref="submission.best.assessment.feedbackDate" />
								</message>
							</title>
							<included>
								<decision reversed="TRUE" model="submission.best.mayReview" />
								<decision model="submission.best.mayReviewLater" />
							</included>
						</navigation>
						<navigation style="LINK" title="list-nav-review-not" disabled="TRUE">
							<included>
								<decision model="submission.best.isComplete" />
								<decision reversed="TRUE" model="submission.best.mayReview" />
								<decision reversed="TRUE" model="submission.best.mayReviewLater" />
							</included>
						</navigation>
					</navigations>
				</column>
			</columns>
		</entityList>
		<instructions selector="list-highest-note" />
	</container>
</interface>
