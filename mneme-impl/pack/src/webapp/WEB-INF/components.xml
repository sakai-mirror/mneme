<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">

<beans>

	<bean id="org.muse.mneme.api.MnemeService"
			class="org.muse.mneme.impl.MnemeServiceImpl"
			init-method="init"
			destroy-method="destroy"
			singleton="true">

		<property name="attachmentService"><ref bean="org.muse.mneme.api.AttachmentService"/></property>
		<property name="assessmentService"><ref bean="org.muse.mneme.api.AssessmentService"/></property>
		<property name="poolService"><ref bean="org.muse.mneme.api.PoolService"/></property>
		<property name="questionService"><ref bean="org.muse.mneme.api.QuestionService"/></property>
		<property name="submissionService"><ref bean="org.muse.mneme.api.SubmissionService"/></property>

		<property name="sqlService"><ref bean="org.sakaiproject.db.api.SqlService"/></property>
		<property name="functionManager"><ref bean="org.sakaiproject.authz.api.FunctionManager"/></property>

 		<property name="autoDdl"><value>${auto.ddl}</value></property>
	</bean>

	<bean id="org.muse.mneme.api.AttachmentService"
			class="org.muse.mneme.impl.AttachmentServiceImpl"
			init-method="init"
			destroy-method="destroy"
			singleton="true">

		<property name="submissionService"><ref bean="org.muse.mneme.api.SubmissionService"/></property>
		<property name="securityService"><ref bean="org.muse.mneme.api.SecurityService"/></property>

		<property name="entityManager"><ref bean="org.sakaiproject.entity.api.EntityManager"/></property>
		<property name="eventTrackingService"><ref bean="org.sakaiproject.event.api.EventTrackingService"/></property>
		<property name="memoryService"><ref bean="org.sakaiproject.memory.api.MemoryService"/></property>
		<property name="sessionManager"><ref bean="org.sakaiproject.tool.api.SessionManager"/></property>
		<property name="serverConfigurationService"><ref bean="org.sakaiproject.component.api.ServerConfigurationService"/></property>
		<property name="sqlService"><ref bean="org.sakaiproject.db.api.SqlService"/></property>
		<property name="threadLocalManager"><ref bean="org.sakaiproject.thread_local.api.ThreadLocalManager"/></property>

 		<property name="cacheMinutes"><value>5</value></property>
 		<property name="cacheCleanerMinutes"><value>15</value></property>
	</bean>

	<bean id="org.muse.mneme.api.PoolService"
		class="org.muse.mneme.impl.PoolServiceImpl"
		init-method="init"
		destroy-method="destroy"
		singleton="true">

		<property name="assessmentService"><ref bean="org.muse.mneme.api.AssessmentService"/></property>
		<property name="securityService"><ref bean="org.muse.mneme.api.SecurityService"/></property>
		<property name="questionService"><ref bean="org.muse.mneme.api.QuestionService"/></property>

		<property name="eventTrackingService"><ref bean="org.sakaiproject.event.api.EventTrackingService"/></property>
		<property name="sessionManager"><ref bean="org.sakaiproject.tool.api.SessionManager"/></property>
		<property name="sqlService"><ref bean="org.sakaiproject.db.api.SqlService"/></property>

		<property name="storage">
			<map>
				<!-- <entry key="default"><ref bean="org.muse.mneme.impl.PoolStorageDefault"/></entry> -->
				<entry key="sample"><ref bean="org.muse.mneme.impl.PoolStorageSample"/></entry>
			</map>
		</property>
		<property name="storageKey"><value>sample</value></property> <!-- use SQL to choose a SQL vendor based storage -->
 	</bean>

	<bean id="org.muse.mneme.impl.PoolStorageSample"
		class="org.muse.mneme.impl.PoolStorageSample"
		init-method="init"
		destroy-method="destroy"
		singleton="true">

		<property name="poolService"><ref bean="org.muse.mneme.api.PoolService"/></property>
		<property name="questionService"><ref bean="org.muse.mneme.api.QuestionService"/></property>
	</bean>

	<bean id="org.muse.mneme.api.QuestionService"
		class="org.muse.mneme.impl.QuestionServiceImpl"
		init-method="init"
		destroy-method="destroy"
		singleton="true">
		
		<property name="mnemeService"><ref bean="org.muse.mneme.api.MnemeService"/></property>
		<property name="poolService"><ref bean="org.muse.mneme.api.PoolService"/></property>
		<property name="securityService"><ref bean="org.muse.mneme.api.SecurityService"/></property>

		<property name="eventTrackingService"><ref bean="org.sakaiproject.event.api.EventTrackingService"/></property>
		<property name="sessionManager"><ref bean="org.sakaiproject.tool.api.SessionManager"/></property>
		<property name="sqlService"><ref bean="org.sakaiproject.db.api.SqlService"/></property>

		<property name="storage">
			<map>
				<!-- <entry key="default"><ref bean="org.muse.mneme.impl.QuestionStorageDefault"/></entry> -->
				<entry key="sample"><ref bean="org.muse.mneme.impl.QuestionStorageSample"/></entry>
			</map>
		</property>
		<property name="storageKey"><value>sample</value></property> <!-- use SQL to choose a SQL vendor based storage -->
	</bean>

	<bean id="org.muse.mneme.impl.QuestionStorageSample"
		class="org.muse.mneme.impl.QuestionStorageSample"
		init-method="init"
		destroy-method="destroy"
		singleton="true">

		<property name="mnemeService"><ref bean="org.muse.mneme.api.MnemeService"/></property>
		<property name="poolService"><ref bean="org.muse.mneme.api.PoolService"/></property>
		<property name="questionService"><ref bean="org.muse.mneme.api.QuestionService"/></property>
	</bean>

	<bean id="org.muse.mneme.api.SubmissionService"
		class="org.muse.mneme.impl.SubmissionServiceImpl"
		init-method="init"
		destroy-method="destroy"
		singleton="true">
		
		<property name="assessmentService"><ref bean="org.muse.mneme.api.AssessmentService"/></property>
		<property name="mnemeService"><ref bean="org.muse.mneme.api.MnemeService"/></property>
		<property name="questionService"><ref bean="org.muse.mneme.api.QuestionService"/></property>
		<property name="securityService"><ref bean="org.muse.mneme.api.SecurityService"/></property>

		<property name="eventTrackingService"><ref bean="org.sakaiproject.event.api.EventTrackingService"/></property>
		<!-- for 2.4 only: <property name="gradebookService"><ref bean="org.sakaiproject.service.gradebook.GradebookExternalAssessmentService"/></property> -->
		<property name="gradebookService"><ref bean="org.sakaiproject.service.gradebook.GradebookService"/></property>
		<property name="sessionManager"><ref bean="org.sakaiproject.tool.api.SessionManager"/></property>
		<property name="sqlService"><ref bean="org.sakaiproject.db.api.SqlService"/></property>
		<property name="threadLocalManager"><ref bean="org.sakaiproject.thread_local.api.ThreadLocalManager"/></property>		

		<property name="storage">
			<map>
				<!-- <entry key="default"><ref bean="org.muse.mneme.impl.SubmissionStorageDefault"/></entry> -->
				<entry key="sample"><ref bean="org.muse.mneme.impl.SubmissionStorageSample"/></entry>
			</map>
		</property>
		<property name="storageKey"><value>sample</value></property> <!-- use SQL to choose a SQL vendor based storage -->
	</bean>

	<bean id="org.muse.mneme.impl.SubmissionStorageSample"
		class="org.muse.mneme.impl.SubmissionStorageSample"
		init-method="init"
		destroy-method="destroy"
		singleton="true">

		<property name="assessmentService"><ref bean="org.muse.mneme.api.AssessmentService"/></property>
		<property name="mnemeService"><ref bean="org.muse.mneme.api.MnemeService"/></property>
		<property name="securityService"><ref bean="org.muse.mneme.api.SecurityService"/></property>
		<property name="submissionService"><ref bean="org.muse.mneme.api.SubmissionService"/></property>
		<property name="sessionManager"><ref bean="org.sakaiproject.tool.api.SessionManager"/></property>
		<property name="userDirectoryService"><ref bean="org.sakaiproject.user.api.UserDirectoryService"/></property>
	</bean>

	<bean id="org.muse.mneme.api.AssessmentService"
		class="org.muse.mneme.impl.AssessmentServiceImpl"
		init-method="init"
		destroy-method="destroy"
		singleton="true">
		
		<property name="poolService"><ref bean="org.muse.mneme.api.PoolService"/></property>
		<property name="questionService"><ref bean="org.muse.mneme.api.QuestionService"/></property>
		<property name="securityService"><ref bean="org.muse.mneme.api.SecurityService"/></property>
		<property name="submissionService"><ref bean="org.muse.mneme.api.SubmissionService"/></property>

		<property name="eventTrackingService"><ref bean="org.sakaiproject.event.api.EventTrackingService"/></property>
		<property name="sessionManager"><ref bean="org.sakaiproject.tool.api.SessionManager"/></property>
		<property name="sqlService"><ref bean="org.sakaiproject.db.api.SqlService"/></property>

		<property name="storage">
			<map>
				<!-- <entry key="default"><ref bean="org.muse.mneme.impl.AssesmentStorageDefault"/></entry> -->
				<entry key="sample"><ref bean="org.muse.mneme.impl.AssessmentStorageSample"/></entry>
			</map>
		</property>
		<property name="storageKey"><value>sample</value></property> <!-- use SQL to choose a SQL vendor based storage -->
	</bean>

	<bean id="org.muse.mneme.impl.AssessmentStorageSample"
		class="org.muse.mneme.impl.AssessmentStorageSample"
		init-method="init"
		destroy-method="destroy"
		singleton="true">

		<property name="poolService"><ref bean="org.muse.mneme.api.PoolService"/></property>
		<property name="questionService"><ref bean="org.muse.mneme.api.QuestionService"/></property>
		<property name="submissionService"><ref bean="org.muse.mneme.api.SubmissionService"/></property>
	</bean>

	<bean id="org.muse.mneme.api.SecurityService"
		class="org.muse.mneme.impl.SecurityServiceImpl"
		init-method="init"
		destroy-method="destroy"
		singleton="true">
		
		<property name="securityService"><ref bean="org.sakaiproject.authz.api.SecurityService"/></property>
		<property name="authzGroupService"><ref bean="org.sakaiproject.authz.api.AuthzGroupService"/></property>
		<property name="siteService"><ref bean="org.sakaiproject.site.api.SiteService"/></property>
	</bean>

	<bean id="org.muse.mneme.impl.TrueFalsePlugin"
		class="org.muse.mneme.impl.TrueFalsePlugin"
		init-method="init"
		destroy-method="destroy"
		singleton="true">

 		<property name="bundle"><value>mnemeTrueFalse</value></property>

		<property name="mnemeService"><ref bean="org.muse.mneme.api.MnemeService"/></property>
 		<property name="ui"><ref bean="org.muse.ambrosia.api.UiService"/></property>
	</bean>

	<bean id="org.muse.mneme.impl.MultipleChoicePlugin"
		class="org.muse.mneme.impl.MultipleChoicePlugin"
		init-method="init"
		destroy-method="destroy"
		singleton="true">

 		<property name="bundle"><value>mnemeMultipleChoice</value></property>

		<property name="mnemeService"><ref bean="org.muse.mneme.api.MnemeService"/></property>
 		<property name="ui"><ref bean="org.muse.ambrosia.api.UiService"/></property>
	</bean>
	
	<bean id="org.muse.mneme.impl.LikertScalePlugin" class="org.muse.mneme.impl.LikertScalePlugin" init-method="init" destroy-method="destroy"
		singleton="true">

		<property name="bundle">
			<value>mnemeLikertScale</value>
		</property>

		<property name="mnemeService">
			<ref bean="org.muse.mneme.api.MnemeService" />
		</property>
		<property name="ui">
			<ref bean="org.muse.ambrosia.api.UiService" />
		</property>
	</bean>	
	
    <bean id="org.muse.mneme.impl.FillBlanksPlugin" class="org.muse.mneme.impl.FillBlanksPlugin" init-method="init" destroy-method="destroy"
		singleton="true">

		<property name="bundle">
			<value>mnemeFillBlanks</value>
		</property>

		<property name="mnemeService">
			<ref bean="org.muse.mneme.api.MnemeService" />
		</property>
		<property name="ui">
			<ref bean="org.muse.ambrosia.api.UiService" />
		</property>
	</bean>		
	<bean id="org.muse.mneme.impl.MatchPlugin"
		class="org.muse.mneme.impl.MatchPlugin"
		init-method="init"
		destroy-method="destroy"
		singleton="true">

 		<property name="bundle"><value>mnemeMatch</value></property>

		<property name="mnemeService"><ref bean="org.muse.mneme.api.MnemeService"/></property>
 		<property name="ui"><ref bean="org.muse.ambrosia.api.UiService"/></property>
	</bean>
	<bean id="org.muse.mneme.impl.EssayPlugin"
		class="org.muse.mneme.impl.EssayPlugin"
		init-method="init"
		destroy-method="destroy"
		singleton="true">

 		<property name="bundle"><value>mnemeEssay</value></property>

		<property name="mnemeService"><ref bean="org.muse.mneme.api.MnemeService"/></property>
 		<property name="ui"><ref bean="org.muse.ambrosia.api.UiService"/></property>
	</bean>	
</beans>
